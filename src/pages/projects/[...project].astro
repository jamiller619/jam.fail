---
import Main from '../../layouts/Main.astro'
import { getCollection, render, type CollectionEntry } from 'astro:content'
import Icon from '../../components/Icon.astro'

export async function getStaticPaths() {
  const projects = await getCollection('projects')

  return projects.map((project) => ({
    params: { project: project.data.title.toLowerCase() },
    props: project,
  }))
}

type Props = CollectionEntry<'projects'>

const project = Astro.props
const { Content } = await render(project)
const { title, description, image, links } = project.data
---

<Main>
  <div
    class="hero container"
    style={{
      backgroundImage: `url(${image.url.src})`,
    }}>
    <h1>{title}</h1>
    <p>{description}</p>
    <div class="links">
      {
        links.map((link) => (
          <a href={link.href}>
            {link.icon && <Icon name={link.icon} />}
            {link.label}
          </a>
        ))
      }
    </div>
  </div>
  <div class="content container">
    <Content />
  </div>
</Main>

<style>
  .hero {
    height: 50vh;
    padding-block-end: var(--size-5);
    min-height: 500px;
    background-size: cover;
    background-position: 50% -15vh;
    display: flex;
    flex-direction: column;
    justify-content: end;
    gap: var(--size-4);
    background-attachment: fixed;

    a {
      display: flex;
      gap: var(--size-2);
      font-size: 1.5rem;
      font-weight: 500;
      color: var(--text-2);

      svg {
        max-inline-size: 1.5rem;
      }

      &:hover {
        color: var(--text-1);
      }
    }
  }

  .links {
    display: flex;
    gap: var(--size-6);
  }

  .content {
    display: flex;
    flex-direction: column;
    gap: var(--size-5);
    margin-block-start: var(--size-8);

    h1,
    h2,
    h3 {
      color: var(--accent);
      margin-block: var(--size-4);
      line-height: var(--font-lineheight-0);
    }

    a {
      color: var(--accent);
      text-decoration: underline;

      &:hover {
        text-decoration: none;
      }
    }

    p,
    li {
      max-inline-size: 100%;
    }

    img {
      margin-block: var(--size-5);
    }

    pre {
      padding: var(--size-5);
      max-inline-size: revert;
    }
  }
</style>
